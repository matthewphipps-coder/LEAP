metadata:
  type: "stage-artifact"
  phase: 14
  phaseName: "Factory Vision Alignment"
  stage: 1
  stageName: "discovery"
  created: "2026-01-19T11:12:00Z"
  completedDate: "2026-01-19T11:37:00Z"
  status: "complete"
  previousPhase: "Phase 13 - DemoFactory Prototype"

discoveryObjective: "Restructure DemoFactory to be a process engine (workflow) rather than a demo instance"

# =============================================================================
# CONTEXT: PHASE 13 LEARNINGS + VISION CLARIFICATION
# =============================================================================

phase13Learnings:
  whatWasBuilt:
    description: "A working web app scaffold with Agentic Dashboard archetype"
    files: 20
    linesOfCode: 3267
    status: "Verified working"
  
  misconception:
    ai_understood: "DemoFactory = the demo itself (the output)"
    actual_vision: "DemoFactory = the PROCESS that creates demos (the workflow)"
  
  technicalLearnings:
    - "ES Modules require local server (cannot use file:// protocol)"
    - "Relative import paths are error-prone (../../ vs ../../../)"
    - "AI-First annotations proved valuable for dependency tracking"
    - "Scaffold-first approach works well"

# =============================================================================
# THREE-LAYER ARCHITECTURE
# =============================================================================

threeLayerArchitecture:
  
  overview:
    layer1: "LEAP - Governance & Gold Source Maintenance"
    layer2: "Factory - Different AI Session (Complete Isolation)"
    layer3: "Demo Output - Final Product (Outside LEAP)"
  
  criticalPrinciple: |
    If LEAP does all of this then the job is too big,
    bias and error creeps in, and control is lost.
    Each layer must be separate with clear boundaries.

# -----------------------------------------------------------------------------
# LAYER 1: LEAP
# -----------------------------------------------------------------------------

  layer1_LEAP:
    role: "Governance & Gold Source Maintenance"
    aiSession: "This conversation (you and me)"
    
    responsibilities:
      - "Maintain Gold Source (scaffold, archetypes, standards)"
      - "Improve factory based on lessons learned from each run"
      - "Trigger factory creation by copying Gold Source"
      - "Close loop: factory success → Gold Source improvements"
    
    canModify: ["/LEAP/*", "Gold Source", "Governance docs"]
    cannotModify: ["Demo instances", "Factory session context"]
    
    continuousImprovement:
      description: "LEAP continuously improves the factory based on success of each run"
      mechanism: |
        Each factory run produces lessons learned.
        LEAP reviews and incorporates into Gold Source.
        The factory keeps getting better.

# -----------------------------------------------------------------------------
# LAYER 2: FACTORY (DIFFERENT AI SESSION)
# -----------------------------------------------------------------------------

  layer2_Factory:
    role: "Process Engine - Guides User Through Demo Creation"
    aiSession: "COMPLETELY SEPARATE CONVERSATION"
    
    sessionProperties:
      isolation: "Complete - no shared context with LEAP"
      history: "Deleted after demo completion"
      context: "Only Gold Source files (self-contained)"
      bias: "Zero carryover from previous demos"
    
    responsibilities:
      - "Guide user through 8 stages with !Proceed gates"
      - "Discover, research, analyze, design user's requirements"
      - "Implement incremental changes for their demo"
      - "Work only within demo instance folder"
    
    canModify: ["Demo instance folder"]
    cannotModify: ["/LEAP/*", "Gold Source (read-only copy)"]
    
    howItKnowsWhatToDo:
      source: "Gold Source is self-contained"
      includes:
        - "Factory instructions (how to run)"
        - "Scaffold (what to build on)"
        - "Architecture (playing field)"
        - "Standards (rules)"
        - "Where to create demo + what to call it"

# -----------------------------------------------------------------------------
# LAYER 3: DEMO OUTPUT
# -----------------------------------------------------------------------------

  layer3_DemoOutput:
    role: "Final Demo - Independent Product"
    location: "Outside LEAP folder entirely"
    
    properties:
      ownership: "User owns it"
      lifecycle: "Independent of LEAP after creation"
      governance: "None (finished product)"
    
    contents:
      - "Working demo code"
      - "Documentation"
      - "Demo-specific tracking (optional)"

# -----------------------------------------------------------------------------
# HANDOFF MECHANISM
# -----------------------------------------------------------------------------

  handoffMechanism:
    step1:
      actor: "LEAP AI"
      action: "Copy Gold Source to create factory workspace"
      note: "Gold Source contains demo location and naming config"
    
    step2:
      actor: "Human"
      action: "Start NEW conversation with Factory AI"
      note: "Point Factory AI at the copied Gold Source"
    
    step3:
      actor: "Factory AI"
      action: "Read Gold Source, know where to create demo"
      note: "Completely fresh context, no LEAP history"
    
    step4:
      actor: "Factory AI + Human"
      action: "Execute 8 stages with !Proceed gates"
      note: "Demo created in location specified by Gold Source"
    
    step5_feedback:
      actor: "Human"
      action: "Report lessons learned back to LEAP"
      note: "LEAP improves Gold Source for next factory run"

# =============================================================================
# FACTORY WORKFLOW
# =============================================================================

factoryWorkflow:
  
  criticalCorrection:
    issue: "Gold Source copy must happen FIRST, before Discovery"
    reason: |
      The factory process needs context to operate:
      - "What's already here?" (code scaffold)
      - "What functionality exists?" (functionality.yaml)
      - "What are the constraints?" (architectural-standards.yaml)
      - "What's the playing field?" (ARCHITECTURE.yaml)
    resolution: "Initialization step BEFORE standard stages"
  
  goldSourceContents:
    description: "Everything the factory needs to operate"
    includes:
      - "Code scaffold (core locked components)"
      - "Archetypes (UI patterns)"
      - "ARCHITECTURE.yaml (playing field)"
      - "architectural-standards.yaml (rules)"
      - "functionality.yaml (what exists)"
      - "Factory CURRENT_STATE.yaml template (track progress)"
  
  process:
    step0_initialization:
      name: "Factory Initialization"
      gate: "!StartFactory"
      actions:
        - "User provides: demo name, location, scenario description"
        - "Copy Gold Source → Demo Instance location"
        - "Initialize demo-specific tracking (CURRENT_STATE.yaml)"
      outcome: "Factory has full context to begin work"
    
    stages_1_to_8:
      note: "IDENTICAL to LEAP lifecycle stages"
      stages:
        - stage: 1
          name: "Discovery"
          purpose: "Define demo requirements based on user scenario"
          gate: "!Proceed"
        
        - stage: 2
          name: "Research"
          purpose: "Explore patterns, components, APIs needed"
          gate: "!Proceed"
        
        - stage: 3
          name: "Analysis"
          purpose: "Risk assessment, approach options"
          gate: "!Proceed"
        
        - stage: 4
          name: "Design"
          purpose: "Implementation plan, file structure"
          gate: "!Proceed"
        
        - stage: 5
          name: "Implementation"
          purpose: "AI implements with human oversight"
          gate: "!Proceed"
        
        - stage: 6
          name: "Delivery"
          purpose: "Package, document"
          gate: "!Proceed"
        
        - stage: 7
          name: "Testing"
          purpose: "Verify demo works as intended"
          gate: "!Proceed"
        
        - stage: 8
          name: "Closure"
          purpose: "Finalize, handoff, lessons learned"
          gate: "Executive sign-off"

# =============================================================================
# PROBLEM STATEMENT
# =============================================================================

problemStatement:
  current: "Phase 13 built a demo instance in DemoFactory/"
  needed: "DemoFactory should be a process engine; scaffold belongs in 2_GoldSource/"
  
  changesRequired:
    - rename: "DemoFactory/ → 2_GoldSource/"
    - create: "DemoFactory/ as process engine"
    - define: "factory-workflow.yaml with phases 1-8"
    - document: "Copy-out process for starting new demos"
    - update: "ARCHITECTURE.yaml to reflect new structure"

# =============================================================================
# QUESTIONS FOR RESEARCH
# =============================================================================

questionsForResearch:
  structure:
    - "Exact folder structure for GoldSource (scaffold vs archetype separation?)"
    - "How should archetypes be packaged? Folders? Manifests?"
    - "Where specifically should demo instances be created? ~/Documents/DemoInstances?"
  
  process:
    - "What does the factory engine look like? YAML workflow? CLI? AI prompt?"
    - "How does the copy-out process work? Full copy or selective?"
    - "How is demo-specific content differentiated from scaffold?"
  
  governance:
    - "Does each demo instance need its own CURRENT_STATE.yaml?"
    - "Should demo instances track their parent archetype version?"
    - "How do we handle updates to GoldSource after demos are created?"

# =============================================================================
# SCOPE
# =============================================================================

scope:
  inScope:
    - "Restructure existing code from DemoFactory/ to 2_GoldSource/"
    - "Create DemoFactory/ as process engine skeleton"
    - "Define factory-workflow.yaml"
    - "Update ARCHITECTURE.yaml"
    - "Document the new structure"
  
  outOfScope:
    - "Building a full CLI or UI for the factory (future phase)"
    - "Creating additional archetypes (future phase)"
    - "Actually running the factory to create a demo (future phase)"

# =============================================================================
# NEXT STAGE
# =============================================================================

nextStage:
  name: "research"
  requires: "!Proceed"
  focus: "Answer questions about folder structure, process engine, governance"
