---
spec_id: SPEC-004
title: Card & Canvas UI
version: 1.0.0
status: draft
created: 2026-01-24
extends: SPEC-003
dependencies:
  - SPEC-003-app-shell.yaml
  - SPEC-002-design-system.yaml
related_discoveries:
  - DISCO-004_Card_And_Canvas_UI
  - DISCO-001_NEXUS_Workbench
  - DISCO-002_Integration_Layer

# IMPORTANT: This spec defines WHAT to build. See VISUAL-GUIDE.md for HOW to build it.
visual_guide: T-2_Design/VISUAL-GUIDE.md
design_reference: T-2_Design/SPEC-004-prototype.html

# =============================================================================
# VISION
# =============================================================================

vision: >
  The canvas is the human-centric view of work. Cards are persistent,
  context-enriched representations of activities that adapt dynamically
  to help users focus on what matters most.

# =============================================================================
# CORE REQUIREMENTS
# =============================================================================

requirements:
  R1:
    title: Show why something matters
    description: Cards display context (e.g., "47 users affected, SLA at risk") not just raw data

  R2:
    title: Surface urgency/importance intelligently
    description: AI-driven prioritization based on time-sensitivity, impact, and user role

  R3:
    title: Reveal patterns and relationships
    description: Visually group related cards and surface insights

  R4:
    title: Adapt dynamically
    description: Cards resize, reposition, and update as urgency changes

  R5:
    title: Work finds the human
    description: Important items surface to the top proactively

  R6:
    title: Simple to browse, powerful to filter
    description: Finder-like ease with advanced filtering capabilities

  R7:
    title: Show time/SLA context
    description: Display due dates, breach risk, and time-based urgency

  R8:
    title: Distinguish work flow directions
    description: Differentiate "to me" vs "from me" vs "with me" work

  R9:
    title: Card presentation is dynamic based on importance
    description: Card size, color, and animation adapt to multiple factors (priority, SLA, role, recency)

  R10:
    title: Importance factors are source-agnostic
    description: Works with any data source through field mapping or AI inference

  R11:
    title: Card prominence is relative to other cards
    description: Visual weight is allocated across the canvas (not all cards can be large/urgent)

# =============================================================================
# COMPONENTS
# =============================================================================

components:
  
  # ---------------------------------------------------------------------------
  # 1. CARD COMPONENT
  # ---------------------------------------------------------------------------
  
  nexus_card:
    description: Visual unit representing a single activity/task
    
    data_model:
      fields:
        - activityId: string        # Source record ID
        - activityType: string      # incident, change, task, etc.
        - title: string             # Primary display text
        - summary: string?          # Secondary context
        - priority: string?         # P1, P2, P3, etc.
        - lastUpdated: timestamp
        - horizon: enum[inbox, now, next, later, done]
        - state: enum[active, tombstone, done]
    
    visual_states:
      compact:
        - Title only
        - Priority badge
        - Min width: 200px
      
      medium:
        - Title
        - Activity type
        - Priority badge
        - Time indicator
        - Width: 300px
      
      large:
        - Title
        - Summary text
        - Priority badge
        - SLA indicator
        - Assignee
        - Max width: 400px
      
      hover:
        - Any card expands to show full details
        - Smooth CSS transition
    
    ai_presentation_attributes:
      position: integer           # Sort order (1 = highest priority)
      size: enum[compact, medium, large]
      accent: enum[none, amber, red]
      animate: boolean            # Pulse/glow for SLA breach
      reason: string?             # AI explanation for presentation
    
    styling:
      base:
        - Glassmorphism (matches workbench)
        - Rounded corners (--radius-md)
        - Subtle shadow (--glass-shadow)
        - Hover lift effect
      
      priority_colors:
        - none: --glass-bg
        - amber: rgba(251, 191, 36, 0.2)
        - red: rgba(239, 68, 68, 0.2)
      
      animations:
        urgentPulse:
          - Subtle border glow
          - 2s ease-in-out infinite
          - Only for SLA breach/escalation
    
    interactions:
      click: Opens workbench (DISCO-001 integration)
      drag_start: Enables drag to horizon filters
      drag_end: Moves card to new horizon
      hover: Expands to show full details
  
  # ---------------------------------------------------------------------------
  # 2. CANVAS CONTAINER
  # ---------------------------------------------------------------------------
  
  nexus_canvas:
    description: Master orchestration layer for card layout
    
    layout_modes:
      grid_mode:
        - Default view
        - CSS Grid with dynamic columns
        - Cards auto-flow with varying sizes
        - Responsive: 1-4 columns based on viewport
      
      list_mode:
        - Activated by "All" filter
        - Horizontal rows (compact card styling)
        - Grouped by horizon (Inbox > Now > Next > Later)
        - Drag-and-drop reordering within groups
    
    ai_sorting:
      trigger: User-initiated "Re-sort" button
      behavior: >
        AI analyzes all active cards and assigns presentation attributes
        (position, size, accent, animate) based on importance factors
      
      constraints:
        - Max 2 "large" cards per view
        - Max 3 "red" accents per view
        - Only 1-2 animated cards at a time
        - Relative allocation (R11): distribute visual weight
    
    stability:
      no_bounce_rule: >
        Cards DO NOT automatically reposition when receiving updates.
        Updates appear in Inbox; user manually re-sorts when ready.
      
      spatial_anchoring: >
        Cards remain in their spatial location unless user explicitly
        moves them or triggers AI re-sort.
  
  # ---------------------------------------------------------------------------
  # 3. NAVIGATION SURFACE
  # ---------------------------------------------------------------------------
  
  nexus_nav:
    description: Context switcher and drop-target for horizons
    
    filters:
      inbox:
        label: Inbox
        icon: inbox
        description: New items + unread updates
        badge: count of unread items
      
      now:
        label: Now
        icon: zap
        description: Active focus items
        badge: count of active items
      
      next:
        label: Next
        icon: clock
        description: Staged for after current work
        badge: count of next items
      
      later:
        label: Later
        icon: calendar
        description: Long-term backlog
        badge: count + urgency indicator (red if contains urgent)
      
      all:
        label: All
        icon: list
        description: Holistic list management
        behavior: Switches to LIST_MODE
      
      done:
        label: Done
        icon: check-circle
        description: Archived/resolved items
        badge: count of done items
    
    interactions:
      click_filter: Switch canvas to show only cards in that horizon
      drop_card: Move card to new horizon
      badge_click: Quick preview of items in that horizon
  
  # ---------------------------------------------------------------------------
  # 4. TOMBSTONE COMPONENT
  # ---------------------------------------------------------------------------
  
  tombstone_card:
    description: Visual state for cards whose source record is inaccessible
    
    appearance:
      - Grayscale/semi-transparent styling
      - Strike-through on title
      - "Unavailable" badge
    
    interaction:
      click: >
        Opens workbench with AI explanation:
        "This work is no longer in your view. The source record was [deleted/archived/permission revoked]."
      
      resolution: User manually marks as Done to clear

# =============================================================================
# VISUAL DESIGN
# =============================================================================

visual_design:
  
  aesthetic:
    - Matches DISCO-001 workbench glassmorphism
    - Dark mode primary, light mode secondary
    - Plasma background (from SPEC-003)
  
  card_grid:
    - CSS Grid with auto-flow
    - Dynamic column count: 1-4 based on viewport
    - Gap: var(--space-md)
    - Cards have varying widths (compact/medium/large)
  
  priority_visualization:
    methods:
      - Size: compact (200px) | medium (300px) | large (400px)
      - Color: none | amber | red accents
      - Position: Higher = more urgent
      - Animation: Pulse for SLA breach only
    
    allocation_principle: >
      Visual weight is distributed relative to other cards (R11).
      If 10 P1s exist, only top 1-2 are large; rest are medium.
  
  responsive_behavior:
    desktop:
      - 3-4 columns
      - Full card details visible
    
    tablet:
      - 2-3 columns
      - Medium cards become dominant
    
    mobile:
      - 1 column
      - Compact cards by default
      - Tap to expand

# =============================================================================
# INTERACTIONS
# =============================================================================

interactions:
  
  card_click:
    behavior: Opens nexus-workbench (DISCO-001)
    transition: Smooth bloom/expand animation
  
  drag_and_drop:
    source: Any card on canvas
    targets:
      - Other cards (reorder within horizon)
      - Nav filter items (move to new horizon)
    
    visual_feedback:
      - Ghost image while dragging
      - Drop zones highlight on hover
      - Smooth animation on drop
  
  ai_resort:
    trigger: User clicks "Re-sort" button
    behavior: >
      1. AI analyzes all active cards
      2. Assigns presentation attributes (position, size, accent, animate)
      3. Cards smoothly animate to new positions
      4. User sees AI explanation for top 3 cards
  
  filter_switching:
    trigger: Click nav filter item
    behavior: >
      - Canvas fades out
      - New filtered set fades in
      - Grid reflows smoothly
      - Preserve scroll position if returning to same filter

# =============================================================================
# PROTOTYPE REQUIREMENTS
# =============================================================================

prototype:
  file: SPEC-004-prototype.html
  extends: SPEC-003-prototype.html
  
  must_demonstrate:
    - 10-15 demo cards with varying priorities
    - All 3 card sizes (compact, medium, large)
    - All 3 accent colors (none, amber, red)
    - At least 1 animated card (SLA breach)
    - All 6 nav filters functional
    - Grid mode and list mode toggle
    - Drag and drop between horizons
    - Card click opens placeholder workbench
    - AI re-sort button (simulated AI response)
    - At least 1 tombstone card
  
  demo_data:
    - Include P1, P2, P3 priorities
    - Include different activity types (incident, change, task)
    - Include cards in all horizons (inbox, now, next, later, done)
    - Include at least 1 card with SLA at risk
    - Include at least 1 tombstone (deleted source record)
  
  visual_contract:
    - Must match SPEC-003 app shell exactly
    - Must use SPEC-002 design tokens
    - Must demonstrate R9 (dynamic sizing) and R11 (relative prominence)
    - Must be self-contained (single HTML file)

# =============================================================================
# IMPLEMENTATION NOTES
# =============================================================================

implementation_notes:
  
  ai_integration:
    - Presentation logic is AI-driven, not hardcoded formulas
    - AI outputs semantic tokens (size, accent, animate)
    - Design system interprets tokens into CSS
    - AI prompt includes Eisenhower principles and user context
  
  data_sync:
    - Cards are user's personal bookmarks, not SoR copies
    - Cards have local state (horizon, read/unread)
    - SoR updates trigger notifications, not automatic re-layout
    - User controls when to re-sort
  
  extensibility:
    - Architecture supports future canvas renderers (CMDB, Gantt, etc.)
    - Architecture supports user-created canvases
    - Architecture supports custom filters
    - Build for current scope, design for future expansion
  
  accessibility:
    - Keyboard navigation for all interactions
    - ARIA labels for all interactive elements
    - Focus indicators for drag-and-drop
    - Color is not the only priority indicator (size + position)
  
  performance:
    - Virtualize cards if >100 visible
    - Debounce drag events
    - Use CSS transforms for animations (GPU acceleration)
    - Lazy load card details on hover

# =============================================================================
# ACCEPTANCE CRITERIA
# =============================================================================

acceptance_criteria:
  
  prototype:
    - Demonstrates all 11 requirements (R1-R11)
    - Visual design matches DISCO-001 workbench aesthetic
    - All interactions feel smooth and responsive
    - Works in Chrome, Safari, Firefox (latest versions)
    - Responsive on desktop, tablet, mobile
    - Accessible via keyboard navigation
  
  code_quality:
    - Self-contained single HTML file
    - Clean, commented CSS
    - Vanilla JavaScript (no frameworks)
    - Uses SPEC-002 design tokens
    - Follows LEAP coding standards
  
  user_validation:
    - User can quickly identify most urgent work
    - User can easily filter and organize cards
    - User understands why certain cards are prominent
    - Drag-and-drop feels natural and intuitive
    - Overall experience feels "intelligent" and "adaptive"

# =============================================================================
# OUT OF SCOPE
# =============================================================================

out_of_scope:
  - User-created canvases (future phase)
  - Custom filters (future phase)
  - Other canvas renderers (CMDB, Gantt, Calendar)
  - Real AI integration (prototype uses simulated AI)
  - Real data sync (prototype uses static demo data)
  - Advanced animations beyond pulse/glow
  - Multi-user collaboration features
  - Mobile app (web-only for now)
