# =============================================================================
# SPRINT FUNCTIONAL SPEC: Design System Enhancement
# =============================================================================
# Source: Old NEXUS STYLE_GUIDE.md, FUNCTIONALITY.md, index.css plasma bubbles
# Purpose: Make GoldSource scaffold visually "WOW" for demos
# =============================================================================

metadata:
  specId: "SPEC-002"
  name: "Design System Enhancement"
  version: "2.1.0"
  created: "2026-01-20"
  lastUpdated: "2026-01-20"
  status: "draft"
  effort: "small"  # REDUCED - focus on core visual polish only
  
  # Backlog linkage
  backlogId: "LEAP-036"
  targetPhase: null

# =============================================================================
# ⚠️ KNOWN ISSUES FROM OLD NEXUS - DO NOT REPEAT
# =============================================================================

knownIssues:
  - id: "ISSUE-001"
    title: "Theme toggle broke NEXUS when retro-fitted"
    description: |
      In old NEXUS, theme toggle was added later and broke several elements.
      Root cause: CSS targeting was inconsistent, some elements used hardcoded
      colors instead of CSS variables.
    prevention: |
      - ALL colors MUST use CSS variables (--bg-*, --text-*, --glass-*)
      - NO hardcoded color values in any CSS
      - Test both themes after every change
      - Theme-specific overrides ONLY in .light-theme {} block
  
  - id: "ISSUE-002"
    title: "Light theme + glass = washed out"
    description: |
      Glassmorphism looks great on dark backgrounds but becomes too transparent
      and washed out on light backgrounds.
    prevention: |
      - Light theme needs DIFFERENT glass values (more opaque, darker tint)
      - .light-theme .glass must override with adjusted opacity
      - Consider using solid light backgrounds instead of glass in light mode
    cssExample: |
      /* Dark theme glass (default) */
      .glass {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
      }
      
      /* Light theme glass - MORE opaque, DARK tint */
      .light-theme .glass {
        background: rgba(0, 0, 0, 0.03);  /* Dark tint instead of white */
        backdrop-filter: blur(12px);       /* Less blur */
        border-color: rgba(0, 0, 0, 0.08); /* Visible border */
      }

  - id: "ISSUE-003"
    title: "Cards not fully defined in GoldSource yet"
    description: |
      SPEC-002 references card animations but GoldSource scaffold doesn't
      have card components defined. Card types will be a separate spec.
    resolution: |
      - This spec provides UTILITY CLASSES (.animate-in, .hover-lift)
      - These classes can be applied to ANY element, not just cards
      - Future card spec will USE these utilities
      - No dependency blocker - utilities work independently

# =============================================================================
# CURRENT STATE - What already exists in GoldSource scaffold
# =============================================================================

currentState:
  summary: "GoldSource has solid foundation but lacks animated background and visual delight"
  
  alreadyImplemented:
    - feature: "CSS Variables"
      location: "ui/styles/variables.css"
      status: "✅ Working"
      note: "Colors, spacing, typography, shadows, transitions"
    
    - feature: "Glassmorphism utility class"
      location: "ui/styles/base.css (.glass)"
      status: "⚠️ Partial"
      note: "Works for dark theme only - light theme is washed out"
    
    - feature: "Button variants"
      location: "ui/styles/buttons.css"
      status: "✅ Working"
      note: "Primary, secondary, ghost, danger + sizes"
    
    - feature: "Dark/Light theme"
      location: "variables.css + theme-manager.js"
      status: "✅ Working"
      note: "Theme toggle with persistence"
  
  missingFeatures:
    - feature: "Animated background (plasma bubbles)"
      impact: "Index page looks static and flat"
      priority: "must-have"
    
    - feature: "Light theme glass fix"
      impact: "Light mode looks washed out"
      priority: "must-have"
    
    - feature: "Entrance animations"
      impact: "Elements appear instantly - no visual delight"
      priority: "should-have"
    
    - feature: "Hover lift effect"
      impact: "Interactive elements feel flat"
      priority: "should-have"
    
    - feature: "Loading/Empty state patterns"
      impact: "No visual feedback during async operations"
      priority: "should-have"

# =============================================================================
# SCOPE DEFINITION - REDUCED FOR PHASE 1
# =============================================================================

scope:
  problem: |
    GoldSource scaffold is functional but visually basic.
    Three main issues:
    1. No animated background - looks static compared to old NEXUS
    2. Light theme glass is washed out and unusable
    3. No easy way to rebrand for customer demos (colors scattered)
    
  goal: |
    PHASE 1: Core visual polish that makes biggest impact with least risk.
    Focus on: Animated background + light theme fix + brand color system.
    Enable: "Change 2 CSS variables = customer-branded demo"
    Defer to future: State patterns, confetti, complex animations.
  
  notInScope:
    - Card type specific styling (separate SPEC-003)
    - Confetti/celebration effects (defer)
    - Complex staggered animations (defer)
    - Priority color system (defer to card spec)
    - Error/Empty/Loading state patterns (defer)
  
  successCriteria:
    - Index page has animated plasma bubbles in background
    - Light theme glass looks solid, not washed out
    - Two brand color variables control entire app look
    - Background has subtle brand color tint (not pure black)
    - .animate-in and .hover-lift utility classes available
    - Button has :active press feedback
    - Both themes tested and working with all changes

# =============================================================================
# FUNCTIONAL REQUIREMENTS - REDUCED SCOPE
# =============================================================================

requirements:
  
  functional:
    # --- PHASE 1 PRIORITY: Visual Impact ---
    
    - id: "FR-001"
      name: "Animated Background (Plasma Bubbles)"
      description: "Floating, morphing colored orbs in the background"
      priority: "must-have"
      currentState: "NOT IMPLEMENTED"
      acceptance: |
        - 2-4 plasma bubble divs positioned absolute in body or main container
        - Each bubble: different size, color (purple, cyan, pink, indigo)
        - Slow floating animation (12-18s cycles)
        - blur(25-40px) for glow effect
        - mix-blend-mode: screen for color mixing
        - Does NOT interfere with page content (z-index behind content)
        - Works in both dark AND light themes
      uiDetails:
        html: |
          <div class="plasma-background">
            <div class="plasma-bubble b1"></div>
            <div class="plasma-bubble b2"></div>
            <div class="plasma-bubble b3"></div>
          </div>
        css: |
          .plasma-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
          }
          
          .plasma-bubble {
            position: absolute;
            border-radius: 50%;
            filter: blur(30px);
            mix-blend-mode: screen;
            opacity: 0.6;
          }
          
          .b1 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.5), transparent 70%);
            top: -100px;
            left: -100px;
            animation: bubbleFloat 15s ease-in-out infinite alternate;
          }
          
          .b2 {
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.4), transparent 70%);
            bottom: 10%;
            right: -50px;
            animation: bubbleFloat 12s ease-in-out infinite alternate-reverse;
          }
          
          .b3 {
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(232, 121, 249, 0.4), transparent 60%);
            top: 40%;
            left: 30%;
            animation: bubbleFloat 18s ease-in-out infinite alternate;
          }
          
          @keyframes bubbleFloat {
            0% { transform: translateY(0) translateX(0) scale(1); }
            100% { transform: translateY(40px) translateX(20px) scale(1.1); }
          }
          
          /* Light theme: reduce intensity */
          .light-theme .plasma-bubble {
            opacity: 0.3;
            mix-blend-mode: multiply;
          }
    
    - id: "FR-002"
      name: "Light Theme Glass Fix"
      description: "Fix washed-out glass effect on light backgrounds"
      priority: "must-have"
      currentState: "NOT IMPLEMENTED - light glass looks washed out"
      acceptance: |
        - .light-theme .glass has different values than dark theme
        - Uses dark tint (rgba(0,0,0,x)) instead of white tint
        - Less blur to maintain readability
        - Visible border for definition
        - All glass elements tested in light mode
      uiDetails:
        css: |
          /* Light theme glass override */
          .light-theme .glass {
            background: rgba(255, 255, 255, 0.7);  /* Solid white, not transparent */
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(0, 0, 0, 0.1);  /* Visible dark border */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
          }
          
          /* Alternative: semi-transparent with dark tint */
          .light-theme .glass-subtle {
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(6px);
            border: 1px solid rgba(0, 0, 0, 0.05);
          }
    
    # --- Brand Customization ---
    - id: "FR-006"
      name: "Brand Color Influence System"
      description: "Two primary brand colors that subtly influence the entire design"
      priority: "must-have"
      currentState: "PARTIAL - has --accent-primary but doesn't influence backgrounds"
      acceptance: |
        - Define --brand-primary and --brand-secondary in :root
        - --bg-primary is NOT pure black, but black with hint of brand color
        - Plasma bubbles use brand colors
        - Accents, glows, and highlights derive from brand colors
        - Changing 2 variables transforms entire app to customer brand
        - Document the pattern in constants.js or variables.css
      example: |
        For ServiceNow: --brand-primary: #62d84e (green), --brand-secondary: #8b5cf6 (purple)
        For IBM: --brand-primary: #0f62fe (blue), --brand-secondary: #be95ff (violet)
      uiDetails:
        cssVariables: |
          :root {
            /* BRAND COLORS - Change these 2 to rebrand the app */
            --brand-primary: #62d84e;    /* ServiceNow green */
            --brand-secondary: #8b5cf6;  /* Purple accent */
            
            /* DERIVED COLORS - These use the brand colors */
            --bg-primary: #0a0a0c;  /* Pure dark... */
            --bg-tinted: color-mix(in srgb, var(--bg-primary) 97%, var(--brand-primary) 3%);
            /* OR fallback for older browsers: */
            --bg-tinted: #0a0c0a;  /* Black with subtle green tint */
            
            /* Accent inherits from brand */
            --accent-primary: var(--brand-primary);
            --accent-glow: color-mix(in srgb, var(--brand-primary) 20%, transparent);
            
            /* Plasma uses brand colors */
            --plasma-1: var(--brand-primary);
            --plasma-2: var(--brand-secondary);
            --plasma-3: color-mix(in srgb, var(--brand-primary) 50%, var(--brand-secondary));
          }
        notes: |
          - color-mix() is modern CSS, may need fallback values
          - The tint should be VERY subtle (2-5%) - muted, not obvious
          - Plasma bubbles should use brand colors at low opacity
          - This enables "Change 2 vars = customer-branded demo"
    
    # --- Utility Classes ---
    - id: "FR-003"
      name: "Entrance Animation Utility"
      description: "Reusable .animate-in class for fade-in-up effect"
      priority: "should-have"
      currentState: "NOT IMPLEMENTED"
      acceptance: |
        - @keyframes fadeInUp defined in animations.css
        - .animate-in utility class applies the animation
        - Animation: 0.6s ease-out
        - Start: opacity 0, translateY(20px)
        - End: opacity 1, translateY(0)
      uiDetails:
        cssCode: |
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(20px) scale(0.98);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          .animate-in {
            animation: fadeInUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) backwards;
          }
    
    - id: "FR-004"
      name: "Hover Lift Utility"
      description: "Reusable .hover-lift class for interactive elements"
      priority: "should-have"
      currentState: "NOT IMPLEMENTED"
      acceptance: |
        - .hover-lift class available
        - On hover: translateY(-4px) scale(1.02)
        - Subtle shadow increase
        - Transition: 0.3s ease-out
      uiDetails:
        cssCode: |
          .hover-lift {
            transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1),
                        box-shadow 0.3s ease-out;
          }
          
          .hover-lift:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
          }
    
    - id: "FR-005"
      name: "Button Press Feedback"
      description: "Buttons show satisfying press animation"
      priority: "should-have"
      currentState: "PARTIAL - has hover, no active state"
      acceptance: |
        - On :active, button scales down slightly (0.97)
        - Quick snap back (0.1s)
        - Works with all button variants
      uiDetails:
        cssCode: |
          .btn:active:not(:disabled) {
            transform: scale(0.97);
            transition: transform 0.1s ease-out;
          }
    
  # ---------------------------------------------------------------------------
  # DEFERRED TO FUTURE SPECS
  # The following were considered but moved to separate specs to reduce scope:
  # ---------------------------------------------------------------------------
  deferred:
    - id: "DEFER-001"
      name: "Loading State Pattern"
      reason: "Nice-to-have, can add in card spec or later"
      
    - id: "DEFER-002"
      name: "Empty State Pattern"  
      reason: "Nice-to-have, can add in card spec or later"
      
    - id: "DEFER-003"
      name: "Error State Pattern"
      reason: "Nice-to-have, can add in card spec or later"
      
    - id: "DEFER-004"
      name: "Priority Color System"
      reason: "Belongs in card types spec where it will be used"
      
    - id: "DEFER-005"
      name: "Glass Variations"
      reason: "FR-002 handles light theme fix; variations can come later"
      
    - id: "DEFER-006"
      name: "Confetti Celebration"
      reason: "Nice-to-have polish, defer to gamification spec"

# =============================================================================
# TECHNICAL APPROACH - REDUCED SCOPE
# =============================================================================

technicalApproach:
  
  affectedFiles:
    new:
      - file: "ui/styles/plasma.css"
        purpose: "Animated background plasma bubbles"
      - file: "ui/styles/animations.css"
        purpose: "Animation keyframes and utility classes"
    
    modify:
      - file: "ui/styles/base.css"
        changes:
          - "Add light theme glass fix (.light-theme .glass)"
          - "Import plasma.css and animations.css"
      
      - file: "ui/styles/buttons.css"
        changes:
          - "Add :active press feedback"
      
      - file: "index.html"
        changes:
          - "Add plasma-background div"
      
      - file: "login.html"
        changes:
          - "Add plasma-background div (optional - may already have stars)"
    
    delete: []
  
  dependencies:
    - "No new dependencies - pure CSS"
  
  patterns:
    - "AI-First headers on new files"
    - "CSS custom properties for all values"
    - "Theme testing: verify dark AND light mode"
    - "No hardcoded colors - use CSS variables"

# =============================================================================
# FACTORY GOVERNANCE IMPACT
# =============================================================================
# Answer: "Does this change introduce new patterns the Factory AI needs to know?"

factoryGovernanceImpact:
  
  introducesNewPatterns: false
  
  governanceUpdatesRequired: []
  
  rationale: |
    Design system changes are purely visual CSS additions.
    New utility classes (.animate-in, .hover-lift) are additive.
    No architectural patterns change.
    Factory AI just copies scaffold and uses existing classes.

# =============================================================================
# VERIFICATION PLAN
# =============================================================================

verification:
  
  manualTests:
    - id: "MT-001"
      name: "Card Entrance Animation"
      description: "Verify cards animate in on page load"
      steps:
        - "Open index.html in browser"
        - "Observe card appear behavior"
      expectedResult: "Cards fade in from below with slight stagger"
    
    - id: "MT-002"
      name: "Hover Lift Effect"
      description: "Verify interactive elements lift on hover"
      steps:
        - "Hover over a card with .hover-lift class"
        - "Observe transform"
      expectedResult: "Card lifts up, shadow increases"
    
    - id: "MT-003"
      name: "Button Press Feedback"
      description: "Verify button has press animation"
      steps:
        - "Click and hold a button"
        - "Observe scale change"
      expectedResult: "Button scales down slightly while pressed"
    
    - id: "MT-004"
      name: "Plasma Bubbles Animation"
      description: "Verify animated background exists and animates"
      steps:
        - "Open index.html in browser"
        - "Observe background"
      expectedResult: "Colored blobs float and morph slowly"
    
    - id: "MT-005"
      name: "Light Theme Glass"
      description: "Verify glass doesn't look washed out in light mode"
      steps:
        - "Toggle to light theme"
        - "Observe any glass elements"
      expectedResult: "Glass has visible definition, not washed out"
    
    - id: "MT-006"
      name: "Both Themes Working"
      description: "Toggle themes and verify nothing breaks"
      steps:
        - "Start in dark mode, observe plasma and glass"
        - "Toggle to light mode"
        - "Toggle back to dark mode"
      expectedResult: "Both modes work, no visual glitches"

# =============================================================================
# APPROVAL
# =============================================================================

approval:
  specApprovedBy: null
  specApprovedDate: null
  implementationApprovedBy: null
  implementationApprovedDate: null

# =============================================================================
# LEGACY REFERENCE - Old NEXUS code (FOR UNDERSTANDING ONLY)
# =============================================================================
# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ ⚠️  THIS IS NOT CODE TO COPY                                              ┃
# ┃                                                                           ┃
# ┃ Purpose: Understand WHAT old NEXUS did (visual effects, patterns)         ┃
# ┃ Reality: Old NEXUS does NOT follow 2_GoldSource/LEAP standards              ┃
# ┃                                                                           ┃
# ┃ LEAP phases will build COMPLETELY NEW compliant code based on:            ┃
# ┃   - The REQUIREMENTS in this spec (FR-xxx)                                ┃
# ┃   - GoldSource architectural-standards.yaml                               ┃
# ┃   - AI-First headers, proper file organization                            ┃
# ┃                                                                           ┃
# ┃ The references below are for CONTEXT ONLY - to understand intent.         ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

legacyReference:
  source: "Old NEXUS STYLE_GUIDE.md and FUNCTIONALITY.md (pre-LEAP, non-compliant)"
  purpose: "Understand WHAT visual effects made NEXUS impressive"
  
  keyPatterns:
    - name: "Card hover effect"
      code: |
        .task-item:hover {
          transform: translateY(-4px) scale(1.02);
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
          border-color: rgba(255, 255, 255, 0.2);
          background: rgba(255, 255, 255, 0.05);
        }
    
    - name: "Entrance animation"
      code: |
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.98);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }
        
        .task-item {
          animation: fadeInUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) backwards;
        }
    
    - name: "Confetti trigger concept"
      note: "Used canvas-confetti library, triggered on task completion"
      
    - name: "Glass variations"
      code: |
        /* Subtle: blur(8px), rgba(2, 6, 23, 0.3) */
        /* Standard: blur(12px), rgba(2, 6, 23, 0.4) */
        /* Heavy: blur(20px), rgba(2, 6, 23, 0.6) */

# =============================================================================
# NOTES
# =============================================================================

notes:
  extractedFrom:
    - "/Users/matthew.phipps/Documents/AGY_ARCHIVE/NEXUS/NEXUS-v5.3.6-dev-20260112-1748/STYLE_GUIDE.md"
    - "/Users/matthew.phipps/Documents/AGY_ARCHIVE/NEXUS/NEXUS-v5.3.6-dev-20260112-1748/FUNCTIONALITY.md"
  
  designPhilosophy: |
    NEXUS visual design was built on these principles:
    - "Glass morphism everywhere"
    - "Smooth transitions on all interactions"
    - "Micro-animations for delight"
    - "The interface should feel alive"
  
  lockedFiles: |
    variables.css and base.css are marked @locked but need minor additions.
    Implementation should ADD new properties, not modify existing ones,
    or propose unlocking if significant changes needed.
  
  futureEnhancements:
    - "Skeleton loading states"
    - "Page transition animations"
    - "Scroll-triggered animations"
    - "Reduced motion accessibility preference"
