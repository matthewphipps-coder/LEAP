# =============================================================================
# STAGE 1: DISCOVERY - Phase 18: NexusReturns
# =============================================================================
# Purpose: Capture requirements for rebuilding Gold Source scaffold properly
# =============================================================================

metadata:
  phase: 18
  name: "NexusReturns"
  stage: 1
  stageName: "discovery"
  created: "2026-01-19T22:26:00Z"
  status: "in-progress"
  author: "Matthew Phipps + AI"

# =============================================================================
# PROBLEM STATEMENT
# =============================================================================

problemStatement: |
  The current Gold Source scaffold is a minimal stub created to prove the Factory 
  process works. It lacks proper architecture, design system, and real functionality.
  
  The old NEXUS demo (in archives) had functional features but was brittle due to 
  "vibe coding" - no governance, no AI-First Code patterns, and ultimately broke 
  when the theme switcher was added.
  
  We need to rebuild the Gold Source scaffold properly, with:
  - Full AI-First Code patterns
  - Proper design system
  - Stable foundation for future Factory feature additions
  
  This is NOT about copying old NEXUS code. It's about building fresh with lessons learned.

# =============================================================================
# SCOPE DEFINITION
# =============================================================================

scope:
  
  inScope:
    pages:
      - name: "Login page"
        description: "Functional authentication with Firebase"
      - name: "Index page"
        description: "Main dashboard shell"
    
    uiShell:
      - name: "Header"
        description: "Top navigation bar"
      - name: "Sidebar"
        description: "Left navigation panel"
      - name: "Canvas"
        description: "Main content area (blank, ready for future cards)"
    
    plumbing:
      - name: "Firebase integration"
        description: "Auth + Firestore structure, wired but minimal"
      - name: "AI service structure"
        description: "Gemini/Claude interface pattern, ready for use"
      - name: "State management"
        description: "Proper subscription pattern, empty initially"
      - name: "Theme system"
        description: "Done right - not spaghetti like old NEXUS"
    
    designSystem:
      - name: "Color palette"
        description: "CSS variables for brand and semantic colors"
      - name: "Typography scale"
        description: "Font families, sizes, weights"
      - name: "Spacing scale"
        description: "Consistent padding/margin units"
      - name: "Glassmorphism base"
        description: "backdrop-filter, transparency, blur effects"
      - name: "Dark mode first"
        description: "Primary theme (light as optional)"
      - name: "Animation tokens"
        description: "Transition durations, easing curves"
    
    componentPatterns:
      - name: "Component template"
        description: "Standard structure with MODULE_CONTRACT, CSS co-location"
      - name: "Button variants"
        description: "Primary, secondary, ghost, danger"
      - name: "Input patterns"
        description: "Text fields, dropdowns"
      - name: "Card base"
        description: "Generic card shell for future card types"
    
    governance:
      - name: "Locked files list"
        description: "What cannot be changed by future Factory runs"
      - name: "Extension points"
        description: "Where Factory CAN add features"
      - name: "functionality.yaml"
        description: "Master feature spec for the scaffold"
      - name: "design-system.yaml"
        description: "Visual identity and tokens spec (NEW)"
  
  outOfScope:
    - "Card types (ping, signal, decision, activity, task) - future Factory runs"
    - "Commands (/scenario, /seed, etc.) - future Factory runs"
    - "Domain-specific enterprise features"
    - "Any code from old NEXUS archive (concepts only, not implementation)"

# =============================================================================
# SOURCE MATERIAL
# =============================================================================

sourceMaterial:
  
  fromOldNexus:
    take:
      - "Feature concepts (card types, commands, interactions)"
      - "Visual/UX patterns (what worked for users)"
    discard:
      - "All code (too much spaghetti)"
      - "Out-of-date functionality.yaml"
      - "Architectural patterns (replace with AI-First Code)"
    location: "/Users/matthew.phipps/Documents/AGY_ARCHIVE/NEXUS/NEXUS"
    note: "Reviewed 2026-01-19 - has 567-line functionality.yaml but outdated"
  
  fromFactoryRuns:
    learnings:
      - "v1.0.2 vs v1.0.3 showed component approach inconsistency"
      - "Service path naming varies (incident/ vs incidents/)"
      - "State patterns differ between runs"
    implication: "New scaffold must define these conventions clearly"
  
  fromBacklog:
    relevantItems:
      - "LEAP-003: Standardize Feature Path Naming"
      - "LEAP-004: Standardize Mock Data Strategy"
      - "LEAP-019: Component Creation vs Modification Policy"
    note: "These scaffold-conventions items should inform the rebuild"

# =============================================================================
# DELIVERABLES
# =============================================================================

deliverables:
  phase18:
    - name: "functionality.yaml (new)"
      description: "Complete feature spec for scaffold v2.0"
      location: "GoldSource/meta/"
    
    - name: "design-system.yaml (new)"
      description: "Visual identity, tokens, and styling spec"
      location: "GoldSource/meta/"
    
    - name: "Rebuilt scaffold code"
      description: "Login, index, shell, plumbing - all with AI-First patterns"
      location: "GoldSource/scaffold/"
    
    - name: "Updated architectural-standards.yaml"
      description: "Conventions defined from backlog learnings"
      location: "GoldSource/meta/"

# =============================================================================
# QUESTIONS FOR RESEARCH STAGE
# =============================================================================

questionsForResearch:
  designSystem:
    - "What color palette should we use? (refer to old NEXUS for inspiration)"
    - "What font families work for the 'future of ServiceNow' aesthetic?"
    - "How should glassmorphism be implemented consistently?"
  
  architecture:
    - "What's the exact locked files list for the new scaffold?"
    - "Where are the extension points for future Factory runs?"
    - "How should state management be structured?"
  
  firebase:
    - "What Firestore collections are needed for the shell?"
    - "Should auth flow match old NEXUS or be simplified?"

# =============================================================================
# NEXT STAGE
# =============================================================================

nextStage:
  name: "research"
  number: 2
  requires: "!Proceed"
  focus: "Answer design/architecture questions, gather reference material"
