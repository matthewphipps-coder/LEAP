metadata:
  type: "state"
  purpose: "Single source of truth for current LEAP work"
  lastUpdated: "2026-01-21T05:13:00Z"
  version: "4.6.0"

aiMustRead:
  - "READ THIS FILE FIRST - at start of every session"
  - "This tells you exactly where we are"
  - "Never assume - check this file for truth"
  - "Update this after every major decision or phase transition"

projectContext:
  name: "LEAP"
  tagline: "AI-First DemoFactory Build & Control Project"
  version: "v1.1.0"
  currentFocus: "Phase 23: Extensible App Shell - Discovery stage"
  vision: "AI Speed + Governance Rigor - see Tracking/VISION.yaml"

currentPhase:
  number: "23"
  name: "ExtensibleAppShell"
  status: "in-progress"
  stage: "discovery"
  startedDate: "2026-01-21T05:13:00Z"
  completedDate: null
  
  goal: "Implement SPEC-003: Transform index.html into extensible scaffold with floating header, page tabs, floating pill sidebar, settings dialog, and multi-page system"
  
  functionalSpec: "LEAP_Governance/SprintFunctionalSpecs/SPEC-003-app-shell.yaml"
  prototype: "LEAP_Governance/SprintFunctionalSpecs/SPEC-003-prototype.html"
  backlogId: "LEAP-037"
  
  stageArtifact: "docs/phases/phase-23/stage-1-discovery.yaml"
  
  previousPhase:
    number: "22"
    name: "DesignSystemEnhancement"
    status: "complete"
    executiveSignOff: "Granted by Matthew Phipps"
  
  # Phase 23 Scope (from SPEC-003)
  sprintScope:
    name: "Extensible App Shell"
    effort: "medium"
    approach: "Spec-driven implementation with prototype as visual contract"
    functionalSpec: "SPEC-003-app-shell.yaml"
    
    requirements:
      mustHave:
        - id: "FR-001"
          name: "Customer Logo Slot"
        - id: "FR-002"
          name: "Page Switcher Tabs"
        - id: "FR-004B"
          name: "Unified Count Badge System"
        - id: "FR-004C"
          name: "Floating Header"
        - id: "FR-004D"
          name: "Settings Dialog"
        - id: "FR-004E"
          name: "Workspace Branding Settings"
        - id: "FR-005"
          name: "Contextual Sidebar Actions"
        - id: "FR-006"
          name: "Floating Pill-Shaped Sidebar"
        - id: "FR-007"
          name: "Multi-Page Canvas System"
      shouldHave:
        - id: "FR-003"
          name: "AI Search Box (slot only)"
        - id: "FR-004"
          name: "Header Action Buttons"
        - id: "FR-008"
          name: "Page Registration Pattern"
    
    affectedFiles:
      new:
        - "core/page-router.js"
        - "ui/components/settings/settings-ui.js"
        - "ui/components/settings/settings.css"
      modify:
        - "core/constants.js"
        - "index.html"
        - "ui/components/header/header-ui.js"
        - "ui/components/header/header.css"
        - "ui/components/sidebar/sidebar-ui.js"
        - "ui/components/sidebar/sidebar.css"
        - "core/app.js"
    
    factoryGovernanceImpact: true
    governanceReason: "Page registration pattern is new - Factory needs to know how to add pages"
  
  breakingChanges:
    - component: "Sidebar"
      change: "Complete replacement: push/pull expand-collapse → floating pill"
    - component: "Header"
      change: "Major enhancement with tabs, search slot, settings"
    - dependency: "Lucide Icons"
      change: "New CDN dependency added to GoldSource"

currentActivity:
  status: "discovery"
  summary: "Starting Phase 23: Extensible App Shell"
  
  recentWork:
    date: "2026-01-21"
    session: "Phase 23 Initialization"
    description: "Critical review complete, prep work done (CSS variables), starting Discovery stage"

    
    sessionChanges:
      backupCreated: "GoldSource_backup_v2.1_pre-phase22"
      gitCommits:
        - "5c17b1b - Add Factory Governance Impact section to specs"
        - "ad332f4 - Backup GoldSource v2.1"
      keyDecisions:
        - "Starting with SPEC-002 (lowest risk, no governance impact)"
        - "Spec-driven implementation approach"

factoryRunsCompleted:
  - demo: "NEXUS v0.0.1-firstTest"
    location: "~/Documents/DemoOutput/Nexus 0.0.1-firstTest/"
    factoryWorkspace: "~/Documents/DemoInstances/Factory-Test-001/"
    note: "First test run - ignored in comparison"
  
  - demo: "NEXUS v1.0.1-major-incident"
    location: "~/Documents/DemoOutput/NEXUS-v1.0.1-major-incident/"
    factoryWorkspace: "~/Documents/DemoInstances/Factory-v1.0.1-major-incident/"
    testsRun: 10
    testsPassed: 10
  
  - demo: "NEXUS v1.0.2-major-incident"
    location: "~/Documents/DemoOutput/NEXUS-v1.0.2-major-incident/"
    factoryWorkspace: "~/Documents/DemoInstances/Factory-v1.0.2-major-incident/"
    testsRun: 8
    testsPassed: 8
  
  - demo: "NEXUS v1.0.3-major-incident"
    location: "~/Documents/DemoOutput/NEXUS-v1.0.3-major-incident/"
    factoryWorkspace: "~/Documents/DemoInstances/Factory-v1.0.3-major-incident/"
    testsRun: 10
    testsPassed: 10
    addedDate: "2026-01-19"
  
  - demo: "NEXUS v2.0.0-major-incident"
    location: "~/Documents/DemoOutput/NEXUS-v2.0.0-major-incident/"
    factoryWorkspace: "~/Documents/DemoInstances/Factory-v2.0.0-major-incident/"
    testsRun: 8
    testsPassed: 8
    addedDate: "2026-01-20"
    note: "First run on Gold Source v2.0 scaffold"
  
  - demo: "NEXUS v2.0.1-major-incident"
    location: "~/Documents/DemoOutput/NEXUS-v2.0.1-major-incident/"
    factoryWorkspace: "~/Documents/DemoInstances/Factory-v2.0.1-major-incident/"
    testsRun: 8
    testsPassed: 8
    addedDate: "2026-01-20"
    note: "Second run on Gold Source v2.0 scaffold"
  
  - demo: "NEXUS v2.0.2-major-incident"
    location: "~/Documents/DemoOutput/NEXUS-v2.0.2-major-incident/"
    factoryWorkspace: "~/Documents/DemoInstances/Factory-v2.0.2-major-incident/"
    testsRun: 5
    testsPassed: 5
    addedDate: "2026-01-20"
    note: "First run using FACTORY_TASK_TEMPLATE.md - compliance validated"
  
  - demo: "NEXUS v2.0.3-major-incident"
    location: "~/Documents/DemoOutput/NEXUS-v2.0.3-major-incident/"
    factoryWorkspace: "~/Documents/DemoInstances/Factory-v2.0.3-major-incident/"
    testsRun: 14
    testsPassed: 12
    addedDate: "2026-01-20"
    note: "Repeat run for comparison - all compliance checks passed, no regressions"
    comparisonReport: "FactoryTestRuns/factory-comparison-v2.0.2-vs-v2.0.3.yaml"
  
  nextRun: "TBD - Factory stable, consider new scenario or archetype"

backlogState:
  totalItems: 48
  complete: 35
  inProgress: 0
  proposed: 7
  superseded: 6
  
  note: "Synced 2026-01-20T23:45:00Z - Added LEAP-040 (Theme Docs) and LEAP-041 (Login Cleanup)"
  
  phase21Complete:
    implemented:
      - "LEAP-007 - Add Dependency Graph to Design"
      - "LEAP-008 - Require Complexity Estimates"
      - "LEAP-009 - Mandate Test Evidence Files"
      - "LEAP-021 - Standardize Analysis Approach Format"
      - "LEAP-022 - Enhance Validation Matrix Template"
      - "LEAP-019 - Component Creation vs Modification Policy"
      - "LEAP-030 - Require Keyboard Accessibility"
      - "LEAP-015 - Create README Template"
    
    verifiedAlreadyDone:
      - "LEAP-003 - Standardize Feature Path Naming"
      - "LEAP-014 - Require functionality.yaml in Demos"
  
  categoriesFile: "LEAP_Governance/tracking/backlog-categories.yaml"
  backlogFile: "LEAP_Governance/tracking/backlog.yaml"

references:
  governanceFiles:
    - "constitution.yaml - Partnership rules"
    - "pulse-protocol.yaml - Development methodology"
    - "safety-protocol.yaml - Backup and deployment"
    - "architectural-standards.yaml - Code patterns"
  
  phase21Targets:
    factoryTemplates:
      - "GoldSource/governance/templates/stage-3-analysis.yaml"
      - "GoldSource/governance/templates/stage-4-design.yaml"
      - "GoldSource/governance/templates/stage-6-validation.yaml"
      - "GoldSource/governance/templates/stage-7-testing.yaml"
    scaffoldConventions:
      - "GoldSource/meta/architectural-standards.yaml"
    demoOutput:
      - "GoldSource/governance/lifecycle-stages.yaml"
      - "GoldSource/governance/templates/README.md"

aiReminders:
  - "Phase 21 IN PROGRESS - Standards & Templates"
  - "10 documentation items (all Small effort)"
  - "NO code changes - docs only"
  - "Sub-phases: A (Factory Templates), B (Scaffold Conventions), C (Demo Output)"
  - "3 items need 'already done' verification in Research stage"
  - "Validation: Factory run v2.0.3 after sprint"
  - "7 factory runs complete (v0.0.1 → v2.0.2)"
